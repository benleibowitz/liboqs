for dir in $1;
do
  patchfiles=`find ./patches/$dir -type f -name "*.patch"`
  for patchfile in $patchfiles;
  do
#    if [[ ! -z "$2" && $2 -eq 0 ]];then
#      git -c core.whitespace=cr-at-eol apply ./patches/$dir/patch0.patch  >/dev/null 2>&1
#      break
#    else
      git apply --check $patchfile >/dev/null 2>&1
      if [ $? -eq 0 ];then
        git -c core.whitespace=cr-at-eol apply $patchfile >/dev/null 2>&1
      fi
#    fi 
  done
done
